<!DOCTYPE html>
<html>
<head>
    <title>Virtue / Vice</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../css/list.css">
    
    <!-- DC Pagination CSS -->
    <link type="text/css" rel="stylesheet" href="../css/tsc_pagination.css" />
    
    <script src="https://cdn.firebase.com/js/client/2.3.1/firebase.js"></script>

<<<<<<< HEAD
        var list = document.getElementById("awards");
        var li = document.createElement("li");
        var value = document.createTextNode("hello world");
            li.appendChild(value);
            list.appendChild(li);

        }      
    </script>
=======
>>>>>>> origin/master
</head>
<body>
    <div>
    <section>
        <h1>Habit List</h1>
        <ul id="habit-list">
            <template id = "habits">
            <li>
                <input type="hidden" name="habit-id">
                <ul class="habit-info">
                    <li><div class="habit-name"></div>
                        <button type="button" class="op op-del" title="delete habit">
                        <img src="../img/delete.svg" alt="Del">
                        </button>
                    
                        <button type="button" class="op op-edit" onclick="location.href='edit.html'" title="edit habit">
                        <img src="../img/edit.svg" alt="Edit">
                        </button>
                    </li>
                    <li><img class="habit-icon" src="" alt="habit icon"></li>
                    <li><p class="habit-desc"></p></li>
                </ul>
                <div class="message">
                    <span class="message-total">
                        <strong>2</strong> days in a row! Best Record: <strong>5</strong><br>
                       <progress class="habit-progress" max="100" value="0"></progress>
                    </span><br>
                    <span class="message-today">Completed <strong id="habitCounter">1</strong>/<strong id="habitStop">1</strong> for today!</span>
                </div>
                <div class="habit-op">
                    <button type="button" class="op op-done" title="done" value="0" data-count-stop="3">
                        <img src="../img/done.svg" alt="Done">
                    </button>
                </div>
            </li>
            </template>
            

        </ul>
        
        <div id="list-pagination">
            <ul class="tsc_pagination tsc_paginationB tsc_paginationB02">
                <li><a href="#" class="current">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li class="unavailable"><a href="">&hellip;</a></li>
                <li><a href="#" class="last">Last</a></li>
            </ul>
        </div>
    </section>

    </div>

    <button type="button" id="addHabit" onclick="location.href='add.html'" title="add habit">+</button>
    
    <script src="../js/list.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script> 
        //to handle habit completed button clicks
        $(document).ready(function(){
            $('.op-done').bind('click', function(e) {
                var counter = $(this).val(); 
                var countstop = $(this).data('countStop');
                var newCount = parseInt(counter) + 1;
               
                $(this).val(newCount);
                
                //display message
                var msgElement = $(this.parentNode.parentNode).find(".message");
                var msgToday = msgElement.find(".message-today");
                
                 if (newCount >= countstop) {
                    //message if habit is completed
                    msgToday.html("Completed Habit!");
                }
                else {
                    var habitCount = msgElement.find("#habitCounter");
                    habitCount.html(newCount);
                    var habitStop = msgElement.find("#habitStop");
                    habitStop.html(countstop);
                }
                
                msgElement.css("visibility","visible");
            });
                                 
        });
    </script>

    <script>   
        // delete habit function
        $(document).ready(function() {
            $('.op-del').on('click', function() {
                var x = confirm("Are you sure you want to delete this habit?");
                if (x) {
                    var child = $(this.parentNode.parentNode.parentNode)
                    child.addClass(' animated fadeOutLeft');
                    child.one('webkitAnimationEnd', function(event) {
                        $(this).remove(); 
                    });                
                }
                else
                    return false;
            });
            
        });
    </script>
<script>
var oFirebaseRef = new Firebase('http://boiling-torch-2236.firebaseIO.com/web/');

window.onload = function()
        {

                    var habitList = document.getElementById("habit-list");
                    var index = 0;
        oFirebaseRef.child("habits").once("value", function(snapshot){
            var sBestRecords = [];
            var sDaily_frequencys = [];
            var sDaysInARows = [];
            var sDescriptions = [];
            var sIcons = [];
            var sTitles = [];
            var sWeekly_frequencys = [];
            
     snapshot.forEach(function(childSnapshot){
                
                var data = childSnapshot.val();
                sBestRecords[index] = data.bestRecord;
                sDaily_frequencys[index] = data.daily_frequency;
                sDaysInARows[index] = data.daysInARow;
                sDescriptions[index] = data.description;
                sIcons[index] = data.icon;
                sTitles[index] = data.title;
                sWeekly_frequencys[index] = data.weekly_frequency;
                console.log(index);
                index++;



                

                
          })
               
                for(i = 0; i<index; i++){
                    var habitListItem = document.getElementById("habits").content.cloneNode(true);
                    habitList.appendChild(habitListItem);
                    console.log(document.getElementsByClassName("habit-name")[i].innerHTML = sTitles[i]);
                    console.log(document.getElementsByClassName("habit-icon")[i].src = sIcons[i]);
                    console.log(document.getElementsByClassName("habit-desc")[i].innerHTML = sDescriptions[i]);
                }
                

        });
        


            
        }    
</script>
    

</body>
</html>